<app-toolbar-form
  [backExists]="true"
  [backIcon]="'back-icon'"
  [viewOnly]="viewOnly"
  [header]="viewOnly ? 'View Clone' : editMode ? 'Edit Clone' : 'Add Clone'"
  (back)="navigateToView()"
></app-toolbar-form>
<form [formGroup]="parentForm" (ngSubmit)="onSubmit()">
  <p-tabs styleClass="p-3">
    <p-tabpanel header="Basic">
      <app-form
        [title]="'MANDATE.BASIC_INFO.TITLE'"
        [description]="'MANDATE.BASIC_INFO.DESCRIPTION'"
        [addChildMandateShowBasicForm]="true"
        [formGroup]="basicForm"
        [editMode]="editMode"
        [viewOnly]="viewOnly"
        [show]="show"
        [clientNames]="clientNames$ | async"
        [validityUnits]="validityUnits$ | async"
        [products]="products$ | async"
        [leasingTypes]="leasingTypes$ | async"
        [insuredBy]="insuredBy$ | async"
      ></app-form>
      <hr />
    </p-tabpanel>
    <p-tabpanel header="Officers">
      <app-form
        [title]="'MANDATE.OFFICERS.TITLE'"
        [description]="'MANDATE.OFFICERS.DESCRIPTION'"
        [addChildMandateShowOfficersForm]="true"
        [formGroup]="officersForm"
        [editMode]="editMode"
        [viewOnly]="viewOnly"
        [officers]="officers$ | async"
        (removeOfficer)="removeOfficer($event)"
        (addOfficer)="addOfficer()"
      ></app-form>
      <hr />
    </p-tabpanel>
    <p-tabpanel header="Contact Persons">
      <app-form
        [title]="'MANDATE.CONTACT_PERSONS.TITLE'"
        [description]="'MANDATE.CONTACT_PERSONS.DESCRIPTION'"
        [addChildMandateShowContactPersonsForm]="true"
        [formGroup]="contactsForm"
        [editMode]="editMode"
        [viewOnly]="viewOnly"
        [contactPersonsList]="contactPersons$ | async"
        (removeContactPerson)="removeContactPerson($event)"
        [currentClientId]="basicForm.get('clientId')?.value"
        (addContactPerson)="addContactPerson()"
        (viewContactPersons)="viewContactPersons($event)"
      ></app-form>
      <hr />
    </p-tabpanel>
    <p-tabpanel header="Asset Types">
      <app-form
        [title]="'MANDATE.ASSET_TYPE.TITLE'"
        [description]="'MANDATE.ASSET_TYPE.DESCRIPTION'"
        [addChildMandateShowAssetTypeForm]="true"
        [formGroup]="assetsForm"
        [editMode]="editMode"
        [viewOnly]="viewOnly"
        [assetTypesList]="assetTypes$ | async"
        (removeAssetType)="removeAssetType($event)"
        (addAssetType)="addAssetType()"
      ></app-form>
      <hr />
    </p-tabpanel>
    <p-tabpanel header="More Information">
      <app-form
        [title]="'MANDATE.MORE_INFO.TITLE'"
        [description]="'MANDATE.MORE_INFO.DESCRIPTION'"
        [addChildMandateShowMoreInformationForm]="true"
        [formGroup]="moreInfoForm"
        [editMode]="editMode"
        [viewOnly]="viewOnly"
        [gracePeriodUnitsList]="gracePeriodUnits$ | async"
        [feesList]="feeTypes$ | async"
      ></app-form>
      <button
        class="submit"
        *ngIf="!editMode && !viewOnly"
        pButton
        type="submit"
        label="Add Child Mandate"
        style="float: right"
      ></button>
      <button
        class="submit"
        *ngIf="editMode && !viewOnly"
        pButton
        type="submit"
        label="Edit Child Mandate"
        style="float: right"
      ></button>
      <button
        class="submit"
        pButton
        type="button"
        label="Close"
        style="float: right"
        (click)="navigateToView()"
        *ngIf="!editMode && viewOnly"
      ></button>
    </p-tabpanel>
  </p-tabs>
</form>
